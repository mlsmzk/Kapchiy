<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Kapchiy Userpage</title>
    <!-- load local stylesheet (css) -->
    <link rel="stylesheet" href="/styles.css" />
    <!-- loading jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h1>Kapchiy</h1>
    <!--partial for navbar-->
    <%- include("partials/navbar_logged_in.ejs") %>

    <!--Header of the page of the user: name, bio, following-->
    <h2><%=user %></h2>
    <h3 id="bio"><%=userBio%></h3>
    <h3 id="followers">Followers: <%=followers.length%></h3>
    <h3 id="following">Following: <%=following.length%></h3>
    <% if (user !== username) { %>
        <form action="/addFollower/<%= user %>" method="POST">
            <button class="followBtn" type="button" name="<%= user %>">
                Follow <%= user %>
              </button>
        </form>
    <% }; %>

    <!--if currentUser == owner of the user page, button to let them edit their bio and such-->
    <% if (user === username) { %>
    <!--upon hitting submit button, do an app.post in server.js-->
    <form method="POST" action="/editBio/<%= user %>">
    <p><label>Edit Bio:
        <textarea placeholder= "<%=userBio%>" rows="3" cols="30" name="bio" maxlength="200"></textarea>
    </label></p>
    <div id="the-count">
        <span id="current">0</span>
        <span id="maximum">/ 200</span>
      </div>
    <p><button type="button" class="editBioBtn" name="<%= user %>">Save Bio</button></p>
   </form>
   <% }; %>
    <!--if currentUser == owner of the user page, button to let them edit their bio and such-->
    <!--User posts-->
    <h2><%= userPosts %></h2>
    <div id="userPosts">
        <% userPosts.forEach((post) => {%>
        <h2><%= post.title %></h2>
        <figure>
            <img class="uploadedImg" src="<%= post.path %>" alt="<%= post.title %>">
            <figcaption><%= post.caption || 'Untitled' %></figcaption>
        </figure>
        <h3>Tags:</h3>
        <ul>
        <% if (post.tags) { %>
            <% post.tags.split(',').forEach((tag) => { %>
            <li><%= tag %></li>
            <% }); %>
        </ul>
        <% } else { %>
        <p>No tags attached to this post</p>
        <% }; %>
        <% }); %>
    </div>


    

  <!-- load local js -->
  <script src="/main.js"></script>
</body>
</html>