<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Kapchiy</title>
    <!-- load local stylesheet (css) -->
    <link rel="stylesheet" href="/styles.css" />
    <!-- loading jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h1>Kapchiy</h1>
    <%- include("partials/flashes.ejs") %> <%# Add flashes partial %>
    <%- include("partials/form.ejs") %>    <%# Add form partial %>
    <%- include("partials/navbar_logged_in.ejs") %> <%# Add flashes partial %>
    
    <% userPosts.forEach((post) => { %>
        <div class="gallery">
            <h2 class="postTitle"><%= post.title %></h2>
            <figure>
                <img class="uploadedImg" src="<%= post.path %>" alt="<%= post.title %>">
                <figcaption><%= post.caption || 'Untitled' %></figcaption>
            </figure>
            <form method="POST" action="/like/<%= post._id %>">
                <button data-liker="<%= username%>" data-id="<%=post._id%>" class="likeBtn" type="button" name="likeBtn">
                  üëç like
                </button>
              </form>

            <p class="likeCounter">
                Likes: <% (post.likes.length > 0) ? post.likes.length : '0' %>
            </p>

            <div class="postTag">Tags:</div>
            <ul>
            <% if (post.tags) { %>
                <% post.tags.split(',').forEach((tag) => { %>
                <li><%= tag %></li>
                <% }); %>
            </ul>
            <% } else { %>
            <p>"No tags attached to this post"</p>
            <% }; %>
        </div>
            <% }); %>
            
    <!-- load local js -->
    <script src="/main.js"></script>
</body>
</html>
